rule Suspicious_Executable {
    meta:
        description = "Détecte les fichiers exécutables suspects"
        severity = "HIGH"
    strings:
        $mz = "MZ"
        $pe = "PE"
        $exe = ".exe"
    condition:
        $mz at 0 and $pe and $exe
}

rule Malicious_Shellcode {
    meta:
        description = "Détecte les shellcodes malveillants"
        severity = "HIGH"
    strings:
        $shellcode1 = { 90 90 90 90 90 90 90 90 }  // NOP sled
        $shellcode2 = { 68 ?? ?? ?? ?? C3 }        // PUSH + RET
    condition:
        any of them
}

rule Suspicious_Strings {
    meta:
        description = "Détecte les chaînes de caractères suspectes"
        severity = "MEDIUM"
    strings:
        $cmd = "cmd.exe" nocase
        $powershell = "powershell" nocase
        $wget = "wget" nocase
        $curl = "curl" nocase
        $download = "download" nocase
    condition:
        2 of them
}

rule Suspicious_IP_Address {
    meta:
        description = "Détecte les adresses IP suspectes"
        severity = "MEDIUM"
    strings:
        $ip = /[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/
    condition:
        $ip
}

rule Suspicious_Process {
    meta:
        description = "Détecte les noms de processus suspects"
        severity = "HIGH"
    strings:
        $process1 = "svchost.exe" nocase
        $process2 = "explorer.exe" nocase
        $process3 = "system32" nocase
    condition:
        any of them
}

rule Suspicious_Registry {
    meta:
        description = "Détecte les modifications de registre suspectes"
        severity = "HIGH"
    strings:
        $reg1 = "HKEY_LOCAL_MACHINE" nocase
        $reg2 = "HKEY_CURRENT_USER" nocase
        $reg3 = "RunOnce" nocase
    condition:
        all of them
}

rule Suspicious_Network {
    meta:
        description = "Détecte les activités réseau suspectes"
        severity = "MEDIUM"
    strings:
        $net1 = "http://" nocase
        $net2 = "https://" nocase
        $net3 = "ftp://" nocase
    condition:
        2 of them
}

rule Suspicious_File_Operations {
    meta:
        description = "Détecte les opérations de fichiers suspectes"
        severity = "MEDIUM"
    strings:
        $file1 = "copy" nocase
        $file2 = "move" nocase
        $file3 = "delete" nocase
    condition:
        2 of them
}

rule Suspicious_System_Commands {
    meta:
        description = "Détecte les commandes système suspectes"
        severity = "HIGH"
    strings:
        $cmd1 = "net user" nocase
        $cmd2 = "net group" nocase
        $cmd3 = "net localgroup" nocase
    condition:
        any of them
}

rule Suspicious_Encryption {
    meta:
        description = "Détecte les opérations de chiffrement suspectes"
        severity = "HIGH"
    strings:
        $enc1 = "AES" nocase
        $enc2 = "RSA" nocase
        $enc3 = "encrypt" nocase
    condition:
        2 of them
} 